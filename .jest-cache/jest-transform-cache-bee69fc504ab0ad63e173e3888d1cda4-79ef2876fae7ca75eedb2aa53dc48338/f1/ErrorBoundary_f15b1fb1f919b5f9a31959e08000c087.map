{"version":3,"names":["_default","ErrorBoundary","_react","Component","constructor","props","cov_27w5zdwfkx","f","s","resetError","setState","hasError","error","state","getDerivedStateFromError","componentDidCatch","errorInfo","componentName","onError","_errorMonitoring","default","handleBoundaryError","componentStack","b","render","children","fallback","_jsxruntime","jsxs","className","jsx","toString","onClick"],"sources":["/Users/yudeyou/Desktop/sm/sociomint/src/components/ErrorBoundary.tsx"],"sourcesContent":["'use client';\n\nimport React, { Component, ErrorInfo, ReactNode } from 'react';\nimport ErrorMonitoring from '../services/errorMonitoring';\n\ninterface ErrorBoundaryProps {\n  children: ReactNode;\n  fallback?: ReactNode | ((error: Error, resetError: () => void) => ReactNode);\n  onError?: (error: Error, errorInfo: ErrorInfo) => void;\n  componentName?: string;\n}\n\ninterface ErrorBoundaryState {\n  hasError: boolean;\n  error: Error | null;\n}\n\n/**\n * 错误边界组件\n *\n * 捕获子组件树中的 JavaScript 错误，记录错误并显示备用 UI\n */\nclass ErrorBoundary extends Component<ErrorBoundaryProps, ErrorBoundaryState> {\n  constructor(props: ErrorBoundaryProps) {\n    super(props);\n    this.state = {\n      hasError: false,\n      error: null,\n    };\n  }\n\n  static getDerivedStateFromError(error: Error): ErrorBoundaryState {\n    // 更新状态，下次渲染时显示备用 UI\n    return {\n      hasError: true,\n      error,\n    };\n  }\n\n  componentDidCatch(error: Error, errorInfo: ErrorInfo): void {\n    // 记录错误信息\n    const { componentName, onError } = this.props;\n\n    // 调用错误监控服务\n    ErrorMonitoring.handleBoundaryError(error, errorInfo.componentStack, componentName);\n\n    // 调用自定义错误处理函数\n    if (onError) {\n      onError(error, errorInfo);\n    }\n  }\n\n  resetError = (): void => {\n    this.setState({\n      hasError: false,\n      error: null,\n    });\n  };\n\n  render(): ReactNode {\n    const { hasError, error } = this.state;\n    const { children, fallback } = this.props;\n\n    if (hasError && error) {\n      // 如果定义了备用UI，则显示备用UI\n      if (fallback) {\n        if (typeof fallback === 'function') {\n          return fallback(error, this.resetError);\n        }\n        return fallback;\n      }\n\n      // 默认的错误UI\n      return (\n        <div className=\"p-4 rounded-lg bg-red-50 border border-red-200\">\n          <h2 className=\"text-lg font-semibold text-red-800 mb-2\">出现了一些问题</h2>\n          <p className=\"text-red-600 mb-4\">\n            应用程序遇到了错误。我们已记录此问题并将尽快修复。\n          </p>\n          <details className=\"text-sm text-gray-700\">\n            <summary className=\"cursor-pointer text-gray-500 hover:text-gray-700\">\n              错误详情\n            </summary>\n            <p className=\"mt-2 p-2 bg-gray-100 rounded overflow-auto\">\n              {error.toString()}\n            </p>\n          </details>\n          <button\n            onClick={this.resetError}\n            className=\"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors\"\n          >\n            重试\n          </button>\n        </div>\n      );\n    }\n\n    // 正常情况下渲染子组件\n    return children;\n  }\n}\n\nexport default ErrorBoundary;\n"],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}