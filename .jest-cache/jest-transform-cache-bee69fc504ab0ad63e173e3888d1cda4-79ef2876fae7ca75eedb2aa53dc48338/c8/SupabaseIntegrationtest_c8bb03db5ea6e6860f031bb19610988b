4acbb7ce9a0ff640ea6959ab29e33788
/**
 * Supabase 集成测试
 * 测试与 Supabase 数据库和 API 的集成
 */ "use strict";
// 模拟 createClient
jest.mock('@supabase/supabase-js', ()=>({
        createClient: jest.fn(()=>mockSupabaseClient)
    }));
Object.defineProperty(exports, "__esModule", {
    value: true
});
// 模拟 Supabase 查询构建器
const mockQueryBuilder = {
    select: jest.fn().mockReturnThis(),
    insert: jest.fn().mockReturnThis(),
    update: jest.fn().mockReturnThis(),
    delete: jest.fn().mockReturnThis(),
    eq: jest.fn().mockReturnThis(),
    neq: jest.fn().mockReturnThis(),
    gt: jest.fn().mockReturnThis(),
    lt: jest.fn().mockReturnThis(),
    gte: jest.fn().mockReturnThis(),
    lte: jest.fn().mockReturnThis(),
    like: jest.fn().mockReturnThis(),
    ilike: jest.fn().mockReturnThis(),
    in: jest.fn().mockReturnThis(),
    order: jest.fn().mockReturnThis(),
    limit: jest.fn().mockReturnThis(),
    range: jest.fn().mockReturnThis(),
    single: jest.fn().mockResolvedValue({
        data: null,
        error: null
    }),
    maybeSingle: jest.fn().mockResolvedValue({
        data: null,
        error: null
    })
};
// 模拟 Supabase 客户端
const mockSupabaseClient = {
    from: jest.fn().mockReturnValue(mockQueryBuilder),
    auth: {
        signUp: jest.fn(),
        signIn: jest.fn(),
        signOut: jest.fn(),
        getUser: jest.fn(),
        onAuthStateChange: jest.fn()
    },
    storage: {
        from: jest.fn()
    },
    rpc: jest.fn()
};
describe('Supabase Integration Tests', ()=>{
    beforeEach(()=>{
        jest.clearAllMocks();
        mockSupabaseClient.from.mockReturnValue(mockQueryBuilder);
    });
    describe('Database Operations', ()=>{
        describe('User Management', ()=>{
            it('should create a new user profile', async ()=>{
                const userData = {
                    id: 'user-123',
                    wallet_address: '0x1234567890abcdef1234567890abcdef12345678',
                    username: 'testuser',
                    email: 'test@example.com',
                    created_at: new Date().toISOString()
                };
                mockQueryBuilder.insert.mockResolvedValue({
                    data: userData,
                    error: null
                });
                const result = await mockSupabaseClient.from('user_profiles').insert(userData);
                expect(mockSupabaseClient.from).toHaveBeenCalledWith('user_profiles');
                expect(mockQueryBuilder.insert).toHaveBeenCalledWith(userData);
                expect(result.data).toEqual(userData);
                expect(result.error).toBeNull();
            });
            it('should fetch user profile by wallet address', async ()=>{
                const walletAddress = '0x1234567890abcdef1234567890abcdef12345678';
                const userData = {
                    id: 'user-123',
                    wallet_address: walletAddress,
                    username: 'testuser',
                    sm_balance: '1000.0'
                };
                mockQueryBuilder.single.mockResolvedValue({
                    data: userData,
                    error: null
                });
                const result = await mockSupabaseClient.from('user_profiles').select('*').eq('wallet_address', walletAddress).single();
                expect(mockQueryBuilder.select).toHaveBeenCalledWith('*');
                expect(mockQueryBuilder.eq).toHaveBeenCalledWith('wallet_address', walletAddress);
                expect(mockQueryBuilder.single).toHaveBeenCalled();
                expect(result.data).toEqual(userData);
            });
            it('should update user balance', async ()=>{
                const userId = 'user-123';
                const newBalance = '1500.0';
                mockQueryBuilder.update.mockResolvedValue({
                    data: {
                        id: userId,
                        sm_balance: newBalance
                    },
                    error: null
                });
                const result = await mockSupabaseClient.from('user_profiles').update({
                    sm_balance: newBalance
                }).eq('id', userId);
                expect(mockQueryBuilder.update).toHaveBeenCalledWith({
                    sm_balance: newBalance
                });
                expect(mockQueryBuilder.eq).toHaveBeenCalledWith('id', userId);
            });
        });
        describe('Transaction History', ()=>{
            it('should record a new transaction', async ()=>{
                const transactionData = {
                    id: 'tx-123',
                    user_id: 'user-123',
                    type: 'exchange',
                    amount_bnb: '0.1',
                    amount_sm: '120.48',
                    tx_hash: '0xabcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890',
                    status: 'completed',
                    created_at: new Date().toISOString()
                };
                mockQueryBuilder.insert.mockResolvedValue({
                    data: transactionData,
                    error: null
                });
                const result = await mockSupabaseClient.from('transactions').insert(transactionData);
                expect(mockSupabaseClient.from).toHaveBeenCalledWith('transactions');
                expect(mockQueryBuilder.insert).toHaveBeenCalledWith(transactionData);
                expect(result.data).toEqual(transactionData);
            });
            it('should fetch user transaction history', async ()=>{
                const userId = 'user-123';
                const transactions = [
                    {
                        id: 'tx-1',
                        type: 'exchange',
                        amount_bnb: '0.1',
                        amount_sm: '120.48',
                        status: 'completed',
                        created_at: '2024-01-01T00:00:00Z'
                    },
                    {
                        id: 'tx-2',
                        type: 'exchange',
                        amount_bnb: '0.05',
                        amount_sm: '60.24',
                        status: 'completed',
                        created_at: '2024-01-02T00:00:00Z'
                    }
                ];
                mockQueryBuilder.select.mockResolvedValue({
                    data: transactions,
                    error: null
                });
                const result = await mockSupabaseClient.from('transactions').select('*').eq('user_id', userId).order('created_at', {
                    ascending: false
                }).limit(10);
                expect(mockQueryBuilder.eq).toHaveBeenCalledWith('user_id', userId);
                expect(mockQueryBuilder.order).toHaveBeenCalledWith('created_at', {
                    ascending: false
                });
                expect(mockQueryBuilder.limit).toHaveBeenCalledWith(10);
                expect(result.data).toEqual(transactions);
            });
            it('should update transaction status', async ()=>{
                const txId = 'tx-123';
                const newStatus = 'failed';
                mockQueryBuilder.update.mockResolvedValue({
                    data: {
                        id: txId,
                        status: newStatus
                    },
                    error: null
                });
                const result = await mockSupabaseClient.from('transactions').update({
                    status: newStatus
                }).eq('id', txId);
                expect(mockQueryBuilder.update).toHaveBeenCalledWith({
                    status: newStatus
                });
                expect(mockQueryBuilder.eq).toHaveBeenCalledWith('id', txId);
            });
        });
        describe('Social Tasks', ()=>{
            it('should create a new social task', async ()=>{
                const taskData = {
                    id: 'task-123',
                    title: 'Follow on Twitter',
                    description: 'Follow our official Twitter account',
                    reward_amount: '10.0',
                    task_type: 'social_follow',
                    platform: 'twitter',
                    target_url: 'https://twitter.com/sociomint',
                    is_active: true,
                    created_at: new Date().toISOString()
                };
                mockQueryBuilder.insert.mockResolvedValue({
                    data: taskData,
                    error: null
                });
                const result = await mockSupabaseClient.from('social_tasks').insert(taskData);
                expect(mockSupabaseClient.from).toHaveBeenCalledWith('social_tasks');
                expect(mockQueryBuilder.insert).toHaveBeenCalledWith(taskData);
                expect(result.data).toEqual(taskData);
            });
            it('should fetch active social tasks', async ()=>{
                const activeTasks = [
                    {
                        id: 'task-1',
                        title: 'Follow on Twitter',
                        reward_amount: '10.0',
                        task_type: 'social_follow',
                        is_active: true
                    },
                    {
                        id: 'task-2',
                        title: 'Join Telegram',
                        reward_amount: '15.0',
                        task_type: 'social_join',
                        is_active: true
                    }
                ];
                mockQueryBuilder.select.mockResolvedValue({
                    data: activeTasks,
                    error: null
                });
                const result = await mockSupabaseClient.from('social_tasks').select('*').eq('is_active', true).order('created_at', {
                    ascending: false
                });
                expect(mockQueryBuilder.eq).toHaveBeenCalledWith('is_active', true);
                expect(mockQueryBuilder.order).toHaveBeenCalledWith('created_at', {
                    ascending: false
                });
                expect(result.data).toEqual(activeTasks);
            });
            it('should record task completion', async ()=>{
                const completionData = {
                    id: 'completion-123',
                    user_id: 'user-123',
                    task_id: 'task-123',
                    status: 'completed',
                    verification_data: {
                        twitter_username: '@testuser'
                    },
                    completed_at: new Date().toISOString()
                };
                mockQueryBuilder.insert.mockResolvedValue({
                    data: completionData,
                    error: null
                });
                const result = await mockSupabaseClient.from('task_completions').insert(completionData);
                expect(mockSupabaseClient.from).toHaveBeenCalledWith('task_completions');
                expect(mockQueryBuilder.insert).toHaveBeenCalledWith(completionData);
                expect(result.data).toEqual(completionData);
            });
        });
    });
    describe('Authentication', ()=>{
        it('should sign up a new user', async ()=>{
            const email = 'test@example.com';
            const password = 'password123';
            const userData = {
                id: 'user-123',
                email,
                email_confirmed_at: new Date().toISOString()
            };
            mockSupabaseClient.auth.signUp.mockResolvedValue({
                data: {
                    user: userData,
                    session: null
                },
                error: null
            });
            const result = await mockSupabaseClient.auth.signUp({
                email,
                password
            });
            expect(mockSupabaseClient.auth.signUp).toHaveBeenCalledWith({
                email,
                password
            });
            expect(result.data.user).toEqual(userData);
            expect(result.error).toBeNull();
        });
        it('should sign in an existing user', async ()=>{
            const email = 'test@example.com';
            const password = 'password123';
            const sessionData = {
                access_token: 'access-token-123',
                refresh_token: 'refresh-token-123',
                user: {
                    id: 'user-123',
                    email
                }
            };
            mockSupabaseClient.auth.signIn.mockResolvedValue({
                data: {
                    session: sessionData
                },
                error: null
            });
            const result = await mockSupabaseClient.auth.signIn({
                email,
                password
            });
            expect(mockSupabaseClient.auth.signIn).toHaveBeenCalledWith({
                email,
                password
            });
            expect(result.data.session).toEqual(sessionData);
        });
        it('should get current user', async ()=>{
            const userData = {
                id: 'user-123',
                email: 'test@example.com',
                aud: 'authenticated'
            };
            mockSupabaseClient.auth.getUser.mockResolvedValue({
                data: {
                    user: userData
                },
                error: null
            });
            const result = await mockSupabaseClient.auth.getUser();
            expect(mockSupabaseClient.auth.getUser).toHaveBeenCalled();
            expect(result.data.user).toEqual(userData);
        });
        it('should sign out user', async ()=>{
            mockSupabaseClient.auth.signOut.mockResolvedValue({
                error: null
            });
            const result = await mockSupabaseClient.auth.signOut();
            expect(mockSupabaseClient.auth.signOut).toHaveBeenCalled();
            expect(result.error).toBeNull();
        });
    });
    describe('Real-time Subscriptions', ()=>{
        it('should set up auth state change listener', ()=>{
            const callback = jest.fn();
            mockSupabaseClient.auth.onAuthStateChange.mockReturnValue({
                data: {
                    subscription: {
                        id: 'sub-123'
                    }
                }
            });
            const subscription = mockSupabaseClient.auth.onAuthStateChange(callback);
            expect(mockSupabaseClient.auth.onAuthStateChange).toHaveBeenCalledWith(callback);
            expect(subscription.data.subscription.id).toBe('sub-123');
        });
    });
    describe('Error Handling', ()=>{
        it('should handle database connection errors', async ()=>{
            const error = new Error('Connection failed');
            mockQueryBuilder.select.mockRejectedValue(error);
            try {
                await mockSupabaseClient.from('user_profiles').select('*');
            } catch (e) {
                expect(e).toEqual(error);
            }
            expect(mockQueryBuilder.select).toHaveBeenCalled();
        });
        it('should handle authentication errors', async ()=>{
            const authError = {
                message: 'Invalid credentials',
                status: 400
            };
            mockSupabaseClient.auth.signIn.mockResolvedValue({
                data: {
                    session: null
                },
                error: authError
            });
            const result = await mockSupabaseClient.auth.signIn({
                email: 'wrong@example.com',
                password: 'wrongpassword'
            });
            expect(result.error).toEqual(authError);
            expect(result.data.session).toBeNull();
        });
        it('should handle API rate limiting', async ()=>{
            const rateLimitError = {
                message: 'Too many requests',
                status: 429
            };
            mockQueryBuilder.select.mockResolvedValue({
                data: null,
                error: rateLimitError
            });
            const result = await mockSupabaseClient.from('user_profiles').select('*');
            expect(result.error).toEqual(rateLimitError);
            expect(result.data).toBeNull();
        });
    });
    describe('Performance Tests', ()=>{
        it('should handle large data queries efficiently', async ()=>{
            const largeDataSet = Array.from({
                length: 1000
            }, (_, i)=>({
                    id: `item-${i}`,
                    data: `data-${i}`
                }));
            mockQueryBuilder.select.mockResolvedValue({
                data: largeDataSet,
                error: null
            });
            const startTime = performance.now();
            const result = await mockSupabaseClient.from('large_table').select('*').limit(1000);
            const endTime = performance.now();
            const queryTime = endTime - startTime;
            expect(queryTime).toBeLessThan(1000); // 应该在1秒内完成
            expect(result.data).toHaveLength(1000);
        });
        it('should handle concurrent requests', async ()=>{
            mockQueryBuilder.select.mockResolvedValue({
                data: [
                    {
                        id: 1,
                        name: 'test'
                    }
                ],
                error: null
            });
            const promises = Array.from({
                length: 10
            }, ()=>mockSupabaseClient.from('test_table').select('*'));
            const results = await Promise.all(promises);
            expect(results).toHaveLength(10);
            results.forEach((result)=>{
                expect(result.data).toEqual([
                    {
                        id: 1,
                        name: 'test'
                    }
                ]);
                expect(result.error).toBeNull();
            });
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy95dWRleW91L0Rlc2t0b3Avc20vc29jaW9taW50L3NyYy9fX3Rlc3RzX18vaW50ZWdyYXRpb24vU3VwYWJhc2VJbnRlZ3JhdGlvbi50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogU3VwYWJhc2Ug6ZuG5oiQ5rWL6K+VXG4gKiDmtYvor5XkuI4gU3VwYWJhc2Ug5pWw5o2u5bqT5ZKMIEFQSSDnmoTpm4bmiJBcbiAqL1xuXG5pbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tICdAc3VwYWJhc2Uvc3VwYWJhc2UtanMnO1xuXG4vLyDmqKHmi58gU3VwYWJhc2Ug5p+l6K+i5p6E5bu65ZmoXG5jb25zdCBtb2NrUXVlcnlCdWlsZGVyID0ge1xuICBzZWxlY3Q6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxuICBpbnNlcnQ6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxuICB1cGRhdGU6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxuICBkZWxldGU6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxuICBlcTogamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCksXG4gIG5lcTogamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCksXG4gIGd0OiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcbiAgbHQ6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxuICBndGU6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxuICBsdGU6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxuICBsaWtlOiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcbiAgaWxpa2U6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxuICBpbjogamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCksXG4gIG9yZGVyOiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcbiAgbGltaXQ6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxuICByYW5nZTogamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCksXG4gIHNpbmdsZTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHsgZGF0YTogbnVsbCwgZXJyb3I6IG51bGwgfSksXG4gIG1heWJlU2luZ2xlOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoeyBkYXRhOiBudWxsLCBlcnJvcjogbnVsbCB9KSxcbn07XG5cbi8vIOaooeaLnyBTdXBhYmFzZSDlrqLmiLfnq69cbmNvbnN0IG1vY2tTdXBhYmFzZUNsaWVudCA9IHtcbiAgZnJvbTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZShtb2NrUXVlcnlCdWlsZGVyKSxcbiAgYXV0aDoge1xuICAgIHNpZ25VcDogamVzdC5mbigpLFxuICAgIHNpZ25JbjogamVzdC5mbigpLFxuICAgIHNpZ25PdXQ6IGplc3QuZm4oKSxcbiAgICBnZXRVc2VyOiBqZXN0LmZuKCksXG4gICAgb25BdXRoU3RhdGVDaGFuZ2U6IGplc3QuZm4oKSxcbiAgfSxcbiAgc3RvcmFnZToge1xuICAgIGZyb206IGplc3QuZm4oKSxcbiAgfSxcbiAgcnBjOiBqZXN0LmZuKCksXG59O1xuXG4vLyDmqKHmi58gY3JlYXRlQ2xpZW50XG5qZXN0Lm1vY2soJ0BzdXBhYmFzZS9zdXBhYmFzZS1qcycsICgpID0+ICh7XG4gIGNyZWF0ZUNsaWVudDogamVzdC5mbigoKSA9PiBtb2NrU3VwYWJhc2VDbGllbnQpLFxufSkpO1xuXG5kZXNjcmliZSgnU3VwYWJhc2UgSW50ZWdyYXRpb24gVGVzdHMnLCAoKSA9PiB7XG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICAgIG1vY2tTdXBhYmFzZUNsaWVudC5mcm9tLm1vY2tSZXR1cm5WYWx1ZShtb2NrUXVlcnlCdWlsZGVyKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0RhdGFiYXNlIE9wZXJhdGlvbnMnLCAoKSA9PiB7XG4gICAgZGVzY3JpYmUoJ1VzZXIgTWFuYWdlbWVudCcsICgpID0+IHtcbiAgICAgIGl0KCdzaG91bGQgY3JlYXRlIGEgbmV3IHVzZXIgcHJvZmlsZScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgdXNlckRhdGEgPSB7XG4gICAgICAgICAgaWQ6ICd1c2VyLTEyMycsXG4gICAgICAgICAgd2FsbGV0X2FkZHJlc3M6ICcweDEyMzQ1Njc4OTBhYmNkZWYxMjM0NTY3ODkwYWJjZGVmMTIzNDU2NzgnLFxuICAgICAgICAgIHVzZXJuYW1lOiAndGVzdHVzZXInLFxuICAgICAgICAgIGVtYWlsOiAndGVzdEBleGFtcGxlLmNvbScsXG4gICAgICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICB9O1xuXG4gICAgICAgIG1vY2tRdWVyeUJ1aWxkZXIuaW5zZXJ0Lm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgICBkYXRhOiB1c2VyRGF0YSxcbiAgICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbW9ja1N1cGFiYXNlQ2xpZW50XG4gICAgICAgICAgLmZyb20oJ3VzZXJfcHJvZmlsZXMnKVxuICAgICAgICAgIC5pbnNlcnQodXNlckRhdGEpO1xuXG4gICAgICAgIGV4cGVjdChtb2NrU3VwYWJhc2VDbGllbnQuZnJvbSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ3VzZXJfcHJvZmlsZXMnKTtcbiAgICAgICAgZXhwZWN0KG1vY2tRdWVyeUJ1aWxkZXIuaW5zZXJ0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh1c2VyRGF0YSk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuZGF0YSkudG9FcXVhbCh1c2VyRGF0YSk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IpLnRvQmVOdWxsKCk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBmZXRjaCB1c2VyIHByb2ZpbGUgYnkgd2FsbGV0IGFkZHJlc3MnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHdhbGxldEFkZHJlc3MgPSAnMHgxMjM0NTY3ODkwYWJjZGVmMTIzNDU2Nzg5MGFiY2RlZjEyMzQ1Njc4JztcbiAgICAgICAgY29uc3QgdXNlckRhdGEgPSB7XG4gICAgICAgICAgaWQ6ICd1c2VyLTEyMycsXG4gICAgICAgICAgd2FsbGV0X2FkZHJlc3M6IHdhbGxldEFkZHJlc3MsXG4gICAgICAgICAgdXNlcm5hbWU6ICd0ZXN0dXNlcicsXG4gICAgICAgICAgc21fYmFsYW5jZTogJzEwMDAuMCcsXG4gICAgICAgIH07XG5cbiAgICAgICAgbW9ja1F1ZXJ5QnVpbGRlci5zaW5nbGUubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICAgIGRhdGE6IHVzZXJEYXRhLFxuICAgICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBtb2NrU3VwYWJhc2VDbGllbnRcbiAgICAgICAgICAuZnJvbSgndXNlcl9wcm9maWxlcycpXG4gICAgICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAgICAgLmVxKCd3YWxsZXRfYWRkcmVzcycsIHdhbGxldEFkZHJlc3MpXG4gICAgICAgICAgLnNpbmdsZSgpO1xuXG4gICAgICAgIGV4cGVjdChtb2NrUXVlcnlCdWlsZGVyLnNlbGVjdCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJyonKTtcbiAgICAgICAgZXhwZWN0KG1vY2tRdWVyeUJ1aWxkZXIuZXEpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCd3YWxsZXRfYWRkcmVzcycsIHdhbGxldEFkZHJlc3MpO1xuICAgICAgICBleHBlY3QobW9ja1F1ZXJ5QnVpbGRlci5zaW5nbGUpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5kYXRhKS50b0VxdWFsKHVzZXJEYXRhKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIHVwZGF0ZSB1c2VyIGJhbGFuY2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHVzZXJJZCA9ICd1c2VyLTEyMyc7XG4gICAgICAgIGNvbnN0IG5ld0JhbGFuY2UgPSAnMTUwMC4wJztcblxuICAgICAgICBtb2NrUXVlcnlCdWlsZGVyLnVwZGF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgZGF0YTogeyBpZDogdXNlcklkLCBzbV9iYWxhbmNlOiBuZXdCYWxhbmNlIH0sXG4gICAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG1vY2tTdXBhYmFzZUNsaWVudFxuICAgICAgICAgIC5mcm9tKCd1c2VyX3Byb2ZpbGVzJylcbiAgICAgICAgICAudXBkYXRlKHsgc21fYmFsYW5jZTogbmV3QmFsYW5jZSB9KVxuICAgICAgICAgIC5lcSgnaWQnLCB1c2VySWQpO1xuXG4gICAgICAgIGV4cGVjdChtb2NrUXVlcnlCdWlsZGVyLnVwZGF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoeyBzbV9iYWxhbmNlOiBuZXdCYWxhbmNlIH0pO1xuICAgICAgICBleHBlY3QobW9ja1F1ZXJ5QnVpbGRlci5lcSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ2lkJywgdXNlcklkKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ1RyYW5zYWN0aW9uIEhpc3RvcnknLCAoKSA9PiB7XG4gICAgICBpdCgnc2hvdWxkIHJlY29yZCBhIG5ldyB0cmFuc2FjdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgdHJhbnNhY3Rpb25EYXRhID0ge1xuICAgICAgICAgIGlkOiAndHgtMTIzJyxcbiAgICAgICAgICB1c2VyX2lkOiAndXNlci0xMjMnLFxuICAgICAgICAgIHR5cGU6ICdleGNoYW5nZScsXG4gICAgICAgICAgYW1vdW50X2JuYjogJzAuMScsXG4gICAgICAgICAgYW1vdW50X3NtOiAnMTIwLjQ4JyxcbiAgICAgICAgICB0eF9oYXNoOiAnMHhhYmNkZWYxMjM0NTY3ODkwYWJjZGVmMTIzNDU2Nzg5MGFiY2RlZjEyMzQ1Njc4OTBhYmNkZWYxMjM0NTY3ODkwJyxcbiAgICAgICAgICBzdGF0dXM6ICdjb21wbGV0ZWQnLFxuICAgICAgICAgIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgfTtcblxuICAgICAgICBtb2NrUXVlcnlCdWlsZGVyLmluc2VydC5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgZGF0YTogdHJhbnNhY3Rpb25EYXRhLFxuICAgICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBtb2NrU3VwYWJhc2VDbGllbnRcbiAgICAgICAgICAuZnJvbSgndHJhbnNhY3Rpb25zJylcbiAgICAgICAgICAuaW5zZXJ0KHRyYW5zYWN0aW9uRGF0YSk7XG5cbiAgICAgICAgZXhwZWN0KG1vY2tTdXBhYmFzZUNsaWVudC5mcm9tKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgndHJhbnNhY3Rpb25zJyk7XG4gICAgICAgIGV4cGVjdChtb2NrUXVlcnlCdWlsZGVyLmluc2VydCkudG9IYXZlQmVlbkNhbGxlZFdpdGgodHJhbnNhY3Rpb25EYXRhKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5kYXRhKS50b0VxdWFsKHRyYW5zYWN0aW9uRGF0YSk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBmZXRjaCB1c2VyIHRyYW5zYWN0aW9uIGhpc3RvcnknLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHVzZXJJZCA9ICd1c2VyLTEyMyc7XG4gICAgICAgIGNvbnN0IHRyYW5zYWN0aW9ucyA9IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBpZDogJ3R4LTEnLFxuICAgICAgICAgICAgdHlwZTogJ2V4Y2hhbmdlJyxcbiAgICAgICAgICAgIGFtb3VudF9ibmI6ICcwLjEnLFxuICAgICAgICAgICAgYW1vdW50X3NtOiAnMTIwLjQ4JyxcbiAgICAgICAgICAgIHN0YXR1czogJ2NvbXBsZXRlZCcsXG4gICAgICAgICAgICBjcmVhdGVkX2F0OiAnMjAyNC0wMS0wMVQwMDowMDowMFonLFxuICAgICAgICAgIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgaWQ6ICd0eC0yJyxcbiAgICAgICAgICAgIHR5cGU6ICdleGNoYW5nZScsXG4gICAgICAgICAgICBhbW91bnRfYm5iOiAnMC4wNScsXG4gICAgICAgICAgICBhbW91bnRfc206ICc2MC4yNCcsXG4gICAgICAgICAgICBzdGF0dXM6ICdjb21wbGV0ZWQnLFxuICAgICAgICAgICAgY3JlYXRlZF9hdDogJzIwMjQtMDEtMDJUMDA6MDA6MDBaJyxcbiAgICAgICAgICB9LFxuICAgICAgICBdO1xuXG4gICAgICAgIG1vY2tRdWVyeUJ1aWxkZXIuc2VsZWN0Lm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgICBkYXRhOiB0cmFuc2FjdGlvbnMsXG4gICAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG1vY2tTdXBhYmFzZUNsaWVudFxuICAgICAgICAgIC5mcm9tKCd0cmFuc2FjdGlvbnMnKVxuICAgICAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgICAgIC5lcSgndXNlcl9pZCcsIHVzZXJJZClcbiAgICAgICAgICAub3JkZXIoJ2NyZWF0ZWRfYXQnLCB7IGFzY2VuZGluZzogZmFsc2UgfSlcbiAgICAgICAgICAubGltaXQoMTApO1xuXG4gICAgICAgIGV4cGVjdChtb2NrUXVlcnlCdWlsZGVyLmVxKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgndXNlcl9pZCcsIHVzZXJJZCk7XG4gICAgICAgIGV4cGVjdChtb2NrUXVlcnlCdWlsZGVyLm9yZGVyKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnY3JlYXRlZF9hdCcsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KTtcbiAgICAgICAgZXhwZWN0KG1vY2tRdWVyeUJ1aWxkZXIubGltaXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDEwKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5kYXRhKS50b0VxdWFsKHRyYW5zYWN0aW9ucyk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCB1cGRhdGUgdHJhbnNhY3Rpb24gc3RhdHVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCB0eElkID0gJ3R4LTEyMyc7XG4gICAgICAgIGNvbnN0IG5ld1N0YXR1cyA9ICdmYWlsZWQnO1xuXG4gICAgICAgIG1vY2tRdWVyeUJ1aWxkZXIudXBkYXRlLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgICBkYXRhOiB7IGlkOiB0eElkLCBzdGF0dXM6IG5ld1N0YXR1cyB9LFxuICAgICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBtb2NrU3VwYWJhc2VDbGllbnRcbiAgICAgICAgICAuZnJvbSgndHJhbnNhY3Rpb25zJylcbiAgICAgICAgICAudXBkYXRlKHsgc3RhdHVzOiBuZXdTdGF0dXMgfSlcbiAgICAgICAgICAuZXEoJ2lkJywgdHhJZCk7XG5cbiAgICAgICAgZXhwZWN0KG1vY2tRdWVyeUJ1aWxkZXIudXBkYXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7IHN0YXR1czogbmV3U3RhdHVzIH0pO1xuICAgICAgICBleHBlY3QobW9ja1F1ZXJ5QnVpbGRlci5lcSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ2lkJywgdHhJZCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdTb2NpYWwgVGFza3MnLCAoKSA9PiB7XG4gICAgICBpdCgnc2hvdWxkIGNyZWF0ZSBhIG5ldyBzb2NpYWwgdGFzaycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgdGFza0RhdGEgPSB7XG4gICAgICAgICAgaWQ6ICd0YXNrLTEyMycsXG4gICAgICAgICAgdGl0bGU6ICdGb2xsb3cgb24gVHdpdHRlcicsXG4gICAgICAgICAgZGVzY3JpcHRpb246ICdGb2xsb3cgb3VyIG9mZmljaWFsIFR3aXR0ZXIgYWNjb3VudCcsXG4gICAgICAgICAgcmV3YXJkX2Ftb3VudDogJzEwLjAnLFxuICAgICAgICAgIHRhc2tfdHlwZTogJ3NvY2lhbF9mb2xsb3cnLFxuICAgICAgICAgIHBsYXRmb3JtOiAndHdpdHRlcicsXG4gICAgICAgICAgdGFyZ2V0X3VybDogJ2h0dHBzOi8vdHdpdHRlci5jb20vc29jaW9taW50JyxcbiAgICAgICAgICBpc19hY3RpdmU6IHRydWUsXG4gICAgICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICB9O1xuXG4gICAgICAgIG1vY2tRdWVyeUJ1aWxkZXIuaW5zZXJ0Lm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgICBkYXRhOiB0YXNrRGF0YSxcbiAgICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbW9ja1N1cGFiYXNlQ2xpZW50XG4gICAgICAgICAgLmZyb20oJ3NvY2lhbF90YXNrcycpXG4gICAgICAgICAgLmluc2VydCh0YXNrRGF0YSk7XG5cbiAgICAgICAgZXhwZWN0KG1vY2tTdXBhYmFzZUNsaWVudC5mcm9tKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnc29jaWFsX3Rhc2tzJyk7XG4gICAgICAgIGV4cGVjdChtb2NrUXVlcnlCdWlsZGVyLmluc2VydCkudG9IYXZlQmVlbkNhbGxlZFdpdGgodGFza0RhdGEpO1xuICAgICAgICBleHBlY3QocmVzdWx0LmRhdGEpLnRvRXF1YWwodGFza0RhdGEpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgZmV0Y2ggYWN0aXZlIHNvY2lhbCB0YXNrcycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgYWN0aXZlVGFza3MgPSBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgaWQ6ICd0YXNrLTEnLFxuICAgICAgICAgICAgdGl0bGU6ICdGb2xsb3cgb24gVHdpdHRlcicsXG4gICAgICAgICAgICByZXdhcmRfYW1vdW50OiAnMTAuMCcsXG4gICAgICAgICAgICB0YXNrX3R5cGU6ICdzb2NpYWxfZm9sbG93JyxcbiAgICAgICAgICAgIGlzX2FjdGl2ZTogdHJ1ZSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGlkOiAndGFzay0yJyxcbiAgICAgICAgICAgIHRpdGxlOiAnSm9pbiBUZWxlZ3JhbScsXG4gICAgICAgICAgICByZXdhcmRfYW1vdW50OiAnMTUuMCcsXG4gICAgICAgICAgICB0YXNrX3R5cGU6ICdzb2NpYWxfam9pbicsXG4gICAgICAgICAgICBpc19hY3RpdmU6IHRydWUsXG4gICAgICAgICAgfSxcbiAgICAgICAgXTtcblxuICAgICAgICBtb2NrUXVlcnlCdWlsZGVyLnNlbGVjdC5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgZGF0YTogYWN0aXZlVGFza3MsXG4gICAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG1vY2tTdXBhYmFzZUNsaWVudFxuICAgICAgICAgIC5mcm9tKCdzb2NpYWxfdGFza3MnKVxuICAgICAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgICAgIC5lcSgnaXNfYWN0aXZlJywgdHJ1ZSlcbiAgICAgICAgICAub3JkZXIoJ2NyZWF0ZWRfYXQnLCB7IGFzY2VuZGluZzogZmFsc2UgfSk7XG5cbiAgICAgICAgZXhwZWN0KG1vY2tRdWVyeUJ1aWxkZXIuZXEpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdpc19hY3RpdmUnLCB0cnVlKTtcbiAgICAgICAgZXhwZWN0KG1vY2tRdWVyeUJ1aWxkZXIub3JkZXIpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdjcmVhdGVkX2F0JywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pO1xuICAgICAgICBleHBlY3QocmVzdWx0LmRhdGEpLnRvRXF1YWwoYWN0aXZlVGFza3MpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgcmVjb3JkIHRhc2sgY29tcGxldGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgY29tcGxldGlvbkRhdGEgPSB7XG4gICAgICAgICAgaWQ6ICdjb21wbGV0aW9uLTEyMycsXG4gICAgICAgICAgdXNlcl9pZDogJ3VzZXItMTIzJyxcbiAgICAgICAgICB0YXNrX2lkOiAndGFzay0xMjMnLFxuICAgICAgICAgIHN0YXR1czogJ2NvbXBsZXRlZCcsXG4gICAgICAgICAgdmVyaWZpY2F0aW9uX2RhdGE6IHsgdHdpdHRlcl91c2VybmFtZTogJ0B0ZXN0dXNlcicgfSxcbiAgICAgICAgICBjb21wbGV0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgfTtcblxuICAgICAgICBtb2NrUXVlcnlCdWlsZGVyLmluc2VydC5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgZGF0YTogY29tcGxldGlvbkRhdGEsXG4gICAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG1vY2tTdXBhYmFzZUNsaWVudFxuICAgICAgICAgIC5mcm9tKCd0YXNrX2NvbXBsZXRpb25zJylcbiAgICAgICAgICAuaW5zZXJ0KGNvbXBsZXRpb25EYXRhKTtcblxuICAgICAgICBleHBlY3QobW9ja1N1cGFiYXNlQ2xpZW50LmZyb20pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCd0YXNrX2NvbXBsZXRpb25zJyk7XG4gICAgICAgIGV4cGVjdChtb2NrUXVlcnlCdWlsZGVyLmluc2VydCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoY29tcGxldGlvbkRhdGEpO1xuICAgICAgICBleHBlY3QocmVzdWx0LmRhdGEpLnRvRXF1YWwoY29tcGxldGlvbkRhdGEpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdBdXRoZW50aWNhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHNpZ24gdXAgYSBuZXcgdXNlcicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGVtYWlsID0gJ3Rlc3RAZXhhbXBsZS5jb20nO1xuICAgICAgY29uc3QgcGFzc3dvcmQgPSAncGFzc3dvcmQxMjMnO1xuICAgICAgY29uc3QgdXNlckRhdGEgPSB7XG4gICAgICAgIGlkOiAndXNlci0xMjMnLFxuICAgICAgICBlbWFpbCxcbiAgICAgICAgZW1haWxfY29uZmlybWVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICB9O1xuXG4gICAgICBtb2NrU3VwYWJhc2VDbGllbnQuYXV0aC5zaWduVXAubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7IHVzZXI6IHVzZXJEYXRhLCBzZXNzaW9uOiBudWxsIH0sXG4gICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG1vY2tTdXBhYmFzZUNsaWVudC5hdXRoLnNpZ25VcCh7XG4gICAgICAgIGVtYWlsLFxuICAgICAgICBwYXNzd29yZCxcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QobW9ja1N1cGFiYXNlQ2xpZW50LmF1dGguc2lnblVwKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIGVtYWlsLFxuICAgICAgICBwYXNzd29yZCxcbiAgICAgIH0pO1xuICAgICAgZXhwZWN0KHJlc3VsdC5kYXRhLnVzZXIpLnRvRXF1YWwodXNlckRhdGEpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvcikudG9CZU51bGwoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc2lnbiBpbiBhbiBleGlzdGluZyB1c2VyJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZW1haWwgPSAndGVzdEBleGFtcGxlLmNvbSc7XG4gICAgICBjb25zdCBwYXNzd29yZCA9ICdwYXNzd29yZDEyMyc7XG4gICAgICBjb25zdCBzZXNzaW9uRGF0YSA9IHtcbiAgICAgICAgYWNjZXNzX3Rva2VuOiAnYWNjZXNzLXRva2VuLTEyMycsXG4gICAgICAgIHJlZnJlc2hfdG9rZW46ICdyZWZyZXNoLXRva2VuLTEyMycsXG4gICAgICAgIHVzZXI6IHsgaWQ6ICd1c2VyLTEyMycsIGVtYWlsIH0sXG4gICAgICB9O1xuXG4gICAgICBtb2NrU3VwYWJhc2VDbGllbnQuYXV0aC5zaWduSW4ubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7IHNlc3Npb246IHNlc3Npb25EYXRhIH0sXG4gICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG1vY2tTdXBhYmFzZUNsaWVudC5hdXRoLnNpZ25Jbih7XG4gICAgICAgIGVtYWlsLFxuICAgICAgICBwYXNzd29yZCxcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QobW9ja1N1cGFiYXNlQ2xpZW50LmF1dGguc2lnbkluKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIGVtYWlsLFxuICAgICAgICBwYXNzd29yZCxcbiAgICAgIH0pO1xuICAgICAgZXhwZWN0KHJlc3VsdC5kYXRhLnNlc3Npb24pLnRvRXF1YWwoc2Vzc2lvbkRhdGEpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBnZXQgY3VycmVudCB1c2VyJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdXNlckRhdGEgPSB7XG4gICAgICAgIGlkOiAndXNlci0xMjMnLFxuICAgICAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICAgICAgICBhdWQ6ICdhdXRoZW50aWNhdGVkJyxcbiAgICAgIH07XG5cbiAgICAgIG1vY2tTdXBhYmFzZUNsaWVudC5hdXRoLmdldFVzZXIubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7IHVzZXI6IHVzZXJEYXRhIH0sXG4gICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG1vY2tTdXBhYmFzZUNsaWVudC5hdXRoLmdldFVzZXIoKTtcblxuICAgICAgZXhwZWN0KG1vY2tTdXBhYmFzZUNsaWVudC5hdXRoLmdldFVzZXIpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZGF0YS51c2VyKS50b0VxdWFsKHVzZXJEYXRhKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc2lnbiBvdXQgdXNlcicsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tTdXBhYmFzZUNsaWVudC5hdXRoLnNpZ25PdXQubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBtb2NrU3VwYWJhc2VDbGllbnQuYXV0aC5zaWduT3V0KCk7XG5cbiAgICAgIGV4cGVjdChtb2NrU3VwYWJhc2VDbGllbnQuYXV0aC5zaWduT3V0KS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICBleHBlY3QocmVzdWx0LmVycm9yKS50b0JlTnVsbCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUmVhbC10aW1lIFN1YnNjcmlwdGlvbnMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBzZXQgdXAgYXV0aCBzdGF0ZSBjaGFuZ2UgbGlzdGVuZXInLCAoKSA9PiB7XG4gICAgICBjb25zdCBjYWxsYmFjayA9IGplc3QuZm4oKTtcblxuICAgICAgbW9ja1N1cGFiYXNlQ2xpZW50LmF1dGgub25BdXRoU3RhdGVDaGFuZ2UubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgZGF0YTogeyBzdWJzY3JpcHRpb246IHsgaWQ6ICdzdWItMTIzJyB9IH0sXG4gICAgICB9KTtcblxuICAgICAgY29uc3Qgc3Vic2NyaXB0aW9uID0gbW9ja1N1cGFiYXNlQ2xpZW50LmF1dGgub25BdXRoU3RhdGVDaGFuZ2UoY2FsbGJhY2spO1xuXG4gICAgICBleHBlY3QobW9ja1N1cGFiYXNlQ2xpZW50LmF1dGgub25BdXRoU3RhdGVDaGFuZ2UpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGNhbGxiYWNrKTtcbiAgICAgIGV4cGVjdChzdWJzY3JpcHRpb24uZGF0YS5zdWJzY3JpcHRpb24uaWQpLnRvQmUoJ3N1Yi0xMjMnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0Vycm9yIEhhbmRsaW5nJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGFuZGxlIGRhdGFiYXNlIGNvbm5lY3Rpb24gZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ0Nvbm5lY3Rpb24gZmFpbGVkJyk7XG4gICAgICBtb2NrUXVlcnlCdWlsZGVyLnNlbGVjdC5tb2NrUmVqZWN0ZWRWYWx1ZShlcnJvcik7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IG1vY2tTdXBhYmFzZUNsaWVudFxuICAgICAgICAgIC5mcm9tKCd1c2VyX3Byb2ZpbGVzJylcbiAgICAgICAgICAuc2VsZWN0KCcqJyk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGV4cGVjdChlKS50b0VxdWFsKGVycm9yKTtcbiAgICAgIH1cblxuICAgICAgZXhwZWN0KG1vY2tRdWVyeUJ1aWxkZXIuc2VsZWN0KS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBhdXRoZW50aWNhdGlvbiBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBhdXRoRXJyb3IgPSB7XG4gICAgICAgIG1lc3NhZ2U6ICdJbnZhbGlkIGNyZWRlbnRpYWxzJyxcbiAgICAgICAgc3RhdHVzOiA0MDAsXG4gICAgICB9O1xuXG4gICAgICBtb2NrU3VwYWJhc2VDbGllbnQuYXV0aC5zaWduSW4ubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7IHNlc3Npb246IG51bGwgfSxcbiAgICAgICAgZXJyb3I6IGF1dGhFcnJvcixcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBtb2NrU3VwYWJhc2VDbGllbnQuYXV0aC5zaWduSW4oe1xuICAgICAgICBlbWFpbDogJ3dyb25nQGV4YW1wbGUuY29tJyxcbiAgICAgICAgcGFzc3dvcmQ6ICd3cm9uZ3Bhc3N3b3JkJyxcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QocmVzdWx0LmVycm9yKS50b0VxdWFsKGF1dGhFcnJvcik7XG4gICAgICBleHBlY3QocmVzdWx0LmRhdGEuc2Vzc2lvbikudG9CZU51bGwoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIEFQSSByYXRlIGxpbWl0aW5nJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmF0ZUxpbWl0RXJyb3IgPSB7XG4gICAgICAgIG1lc3NhZ2U6ICdUb28gbWFueSByZXF1ZXN0cycsXG4gICAgICAgIHN0YXR1czogNDI5LFxuICAgICAgfTtcblxuICAgICAgbW9ja1F1ZXJ5QnVpbGRlci5zZWxlY3QubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiBudWxsLFxuICAgICAgICBlcnJvcjogcmF0ZUxpbWl0RXJyb3IsXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbW9ja1N1cGFiYXNlQ2xpZW50XG4gICAgICAgIC5mcm9tKCd1c2VyX3Byb2ZpbGVzJylcbiAgICAgICAgLnNlbGVjdCgnKicpO1xuXG4gICAgICBleHBlY3QocmVzdWx0LmVycm9yKS50b0VxdWFsKHJhdGVMaW1pdEVycm9yKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZGF0YSkudG9CZU51bGwoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1BlcmZvcm1hbmNlIFRlc3RzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGFuZGxlIGxhcmdlIGRhdGEgcXVlcmllcyBlZmZpY2llbnRseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGxhcmdlRGF0YVNldCA9IEFycmF5LmZyb20oeyBsZW5ndGg6IDEwMDAgfSwgKF8sIGkpID0+ICh7XG4gICAgICAgIGlkOiBgaXRlbS0ke2l9YCxcbiAgICAgICAgZGF0YTogYGRhdGEtJHtpfWAsXG4gICAgICB9KSk7XG5cbiAgICAgIG1vY2tRdWVyeUJ1aWxkZXIuc2VsZWN0Lm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YTogbGFyZ2VEYXRhU2V0LFxuICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBzdGFydFRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbW9ja1N1cGFiYXNlQ2xpZW50XG4gICAgICAgIC5mcm9tKCdsYXJnZV90YWJsZScpXG4gICAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgICAubGltaXQoMTAwMCk7XG5cbiAgICAgIGNvbnN0IGVuZFRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKTtcbiAgICAgIGNvbnN0IHF1ZXJ5VGltZSA9IGVuZFRpbWUgLSBzdGFydFRpbWU7XG5cbiAgICAgIGV4cGVjdChxdWVyeVRpbWUpLnRvQmVMZXNzVGhhbigxMDAwKTsgLy8g5bqU6K+l5ZyoMeenkuWGheWujOaIkFxuICAgICAgZXhwZWN0KHJlc3VsdC5kYXRhKS50b0hhdmVMZW5ndGgoMTAwMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBjb25jdXJyZW50IHJlcXVlc3RzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1F1ZXJ5QnVpbGRlci5zZWxlY3QubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiBbeyBpZDogMSwgbmFtZTogJ3Rlc3QnIH1dLFxuICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBwcm9taXNlcyA9IEFycmF5LmZyb20oeyBsZW5ndGg6IDEwIH0sICgpID0+XG4gICAgICAgIG1vY2tTdXBhYmFzZUNsaWVudFxuICAgICAgICAgIC5mcm9tKCd0ZXN0X3RhYmxlJylcbiAgICAgICAgICAuc2VsZWN0KCcqJylcbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdHMgPSBhd2FpdCBQcm9taXNlLmFsbChwcm9taXNlcyk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHRzKS50b0hhdmVMZW5ndGgoMTApO1xuICAgICAgcmVzdWx0cy5mb3JFYWNoKHJlc3VsdCA9PiB7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuZGF0YSkudG9FcXVhbChbeyBpZDogMSwgbmFtZTogJ3Rlc3QnIH1dKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvcikudG9CZU51bGwoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl0sIm5hbWVzIjpbImplc3QiLCJtb2NrIiwiY3JlYXRlQ2xpZW50IiwiZm4iLCJtb2NrU3VwYWJhc2VDbGllbnQiLCJtb2NrUXVlcnlCdWlsZGVyIiwic2VsZWN0IiwibW9ja1JldHVyblRoaXMiLCJpbnNlcnQiLCJ1cGRhdGUiLCJkZWxldGUiLCJlcSIsIm5lcSIsImd0IiwibHQiLCJndGUiLCJsdGUiLCJsaWtlIiwiaWxpa2UiLCJpbiIsIm9yZGVyIiwibGltaXQiLCJyYW5nZSIsInNpbmdsZSIsIm1vY2tSZXNvbHZlZFZhbHVlIiwiZGF0YSIsImVycm9yIiwibWF5YmVTaW5nbGUiLCJmcm9tIiwibW9ja1JldHVyblZhbHVlIiwiYXV0aCIsInNpZ25VcCIsInNpZ25JbiIsInNpZ25PdXQiLCJnZXRVc2VyIiwib25BdXRoU3RhdGVDaGFuZ2UiLCJzdG9yYWdlIiwicnBjIiwiZGVzY3JpYmUiLCJiZWZvcmVFYWNoIiwiY2xlYXJBbGxNb2NrcyIsIml0IiwidXNlckRhdGEiLCJpZCIsIndhbGxldF9hZGRyZXNzIiwidXNlcm5hbWUiLCJlbWFpbCIsImNyZWF0ZWRfYXQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJyZXN1bHQiLCJleHBlY3QiLCJ0b0hhdmVCZWVuQ2FsbGVkV2l0aCIsInRvRXF1YWwiLCJ0b0JlTnVsbCIsIndhbGxldEFkZHJlc3MiLCJzbV9iYWxhbmNlIiwidG9IYXZlQmVlbkNhbGxlZCIsInVzZXJJZCIsIm5ld0JhbGFuY2UiLCJ0cmFuc2FjdGlvbkRhdGEiLCJ1c2VyX2lkIiwidHlwZSIsImFtb3VudF9ibmIiLCJhbW91bnRfc20iLCJ0eF9oYXNoIiwic3RhdHVzIiwidHJhbnNhY3Rpb25zIiwiYXNjZW5kaW5nIiwidHhJZCIsIm5ld1N0YXR1cyIsInRhc2tEYXRhIiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsInJld2FyZF9hbW91bnQiLCJ0YXNrX3R5cGUiLCJwbGF0Zm9ybSIsInRhcmdldF91cmwiLCJpc19hY3RpdmUiLCJhY3RpdmVUYXNrcyIsImNvbXBsZXRpb25EYXRhIiwidGFza19pZCIsInZlcmlmaWNhdGlvbl9kYXRhIiwidHdpdHRlcl91c2VybmFtZSIsImNvbXBsZXRlZF9hdCIsInBhc3N3b3JkIiwiZW1haWxfY29uZmlybWVkX2F0IiwidXNlciIsInNlc3Npb24iLCJzZXNzaW9uRGF0YSIsImFjY2Vzc190b2tlbiIsInJlZnJlc2hfdG9rZW4iLCJhdWQiLCJjYWxsYmFjayIsInN1YnNjcmlwdGlvbiIsInRvQmUiLCJFcnJvciIsIm1vY2tSZWplY3RlZFZhbHVlIiwiZSIsImF1dGhFcnJvciIsIm1lc3NhZ2UiLCJyYXRlTGltaXRFcnJvciIsImxhcmdlRGF0YVNldCIsIkFycmF5IiwibGVuZ3RoIiwiXyIsImkiLCJzdGFydFRpbWUiLCJwZXJmb3JtYW5jZSIsIm5vdyIsImVuZFRpbWUiLCJxdWVyeVRpbWUiLCJ0b0JlTGVzc1RoYW4iLCJ0b0hhdmVMZW5ndGgiLCJuYW1lIiwicHJvbWlzZXMiLCJyZXN1bHRzIiwiUHJvbWlzZSIsImFsbCIsImZvckVhY2giXSwibWFwcGluZ3MiOiJBQUFBOzs7Q0FHQztBQTBDRCxrQkFBa0I7QUFDbEJBLEtBQUtDLElBQUksQ0FBQyx5QkFBeUIsSUFBTyxDQUFBO1FBQ3hDQyxjQUFjRixLQUFLRyxFQUFFLENBQUMsSUFBTUM7SUFDOUIsQ0FBQTs7OztBQXpDQSxvQkFBb0I7QUFDcEIsTUFBTUMsbUJBQW1CO0lBQ3ZCQyxRQUFRTixLQUFLRyxFQUFFLEdBQUdJLGNBQWM7SUFDaENDLFFBQVFS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