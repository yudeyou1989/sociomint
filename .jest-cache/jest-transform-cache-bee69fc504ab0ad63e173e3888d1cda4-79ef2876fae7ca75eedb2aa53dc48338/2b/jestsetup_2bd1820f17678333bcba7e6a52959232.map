{"version":3,"sources":["/Users/yudeyou/Desktop/sm/sociomint/jest.setup.js"],"sourcesContent":["// 导入测试库\nimport '@testing-library/jest-dom';\n\n// 解决BigInt序列化问题\nBigInt.prototype.toJSON = function() {\n  return this.toString();\n};\n\n// 全局模拟\nglobal.fetch = jest.fn();\n\n// 模拟 window.ethereum (只在未定义时创建)\nif (!window.ethereum) {\n  Object.defineProperty(window, 'ethereum', {\n    writable: true,\n    configurable: true,\n    value: {\n      request: jest.fn(),\n      on: jest.fn(),\n      removeListener: jest.fn(),\n      isMetaMask: true,\n    },\n  });\n}\n\n// 模拟 ResizeObserver\nglobal.ResizeObserver = jest.fn().mockImplementation(() => ({\n  observe: jest.fn(),\n  unobserve: jest.fn(),\n  disconnect: jest.fn(),\n}));\n\n// 模拟 IntersectionObserver\nglobal.IntersectionObserver = jest.fn().mockImplementation(() => ({\n  observe: jest.fn(),\n  unobserve: jest.fn(),\n  disconnect: jest.fn(),\n}));\n\n// 模拟 matchMedia\nObject.defineProperty(window, 'matchMedia', {\n  writable: true,\n  value: jest.fn().mockImplementation(query => ({\n    matches: false,\n    media: query,\n    onchange: null,\n    addListener: jest.fn(), // deprecated\n    removeListener: jest.fn(), // deprecated\n    addEventListener: jest.fn(),\n    removeEventListener: jest.fn(),\n    dispatchEvent: jest.fn(),\n  })),\n});\n\n// 模拟 localStorage\nconst localStorageMock = {\n  getItem: jest.fn(),\n  setItem: jest.fn(),\n  removeItem: jest.fn(),\n  clear: jest.fn(),\n};\nglobal.localStorage = localStorageMock;\n\n// 模拟 sessionStorage\nconst sessionStorageMock = {\n  getItem: jest.fn(),\n  setItem: jest.fn(),\n  removeItem: jest.fn(),\n  clear: jest.fn(),\n};\nglobal.sessionStorage = sessionStorageMock;\n\n// 模拟console.error以捕获React警告\nconst originalConsoleError = console.error;\nconsole.error = (...args) => {\n  if (/Warning.*not wrapped in act/.test(args[0])) {\n    return;\n  }\n  originalConsoleError(...args);\n};\n\n// 模拟 Next.js 路由\njest.mock('next/router', () => ({\n  useRouter: () => ({\n    push: jest.fn(),\n    replace: jest.fn(),\n    back: jest.fn(),\n    pathname: '/',\n    query: {},\n    asPath: '/',\n  }),\n}));\n\n// 模拟 Next.js 导航\njest.mock('next/navigation', () => ({\n  useRouter: () => ({\n    push: jest.fn(),\n    replace: jest.fn(),\n    back: jest.fn(),\n    pathname: '/',\n    searchParams: new URLSearchParams(),\n  }),\n  usePathname: () => '/',\n  useSearchParams: () => new URLSearchParams(),\n}));\n\n// 模拟 Web3 相关\njest.mock('@wagmi/core', () => ({\n  useAccount: () => ({ address: undefined, isConnected: false }),\n  useConnect: () => ({ connect: jest.fn(), connectors: [] }),\n  useDisconnect: () => ({ disconnect: jest.fn() }),\n  useBalance: () => ({ data: undefined }),\n}));\n\n// 模拟 ethers\njest.mock('ethers', () => ({\n  ethers: {\n    providers: {\n      JsonRpcProvider: jest.fn(),\n    },\n    Contract: jest.fn(),\n    utils: {\n      formatEther: jest.fn(),\n      parseEther: jest.fn(),\n    },\n  },\n}));\n"],"names":["jest","mock","useRouter","push","fn","replace","back","pathname","query","asPath","searchParams","URLSearchParams","usePathname","useSearchParams","useAccount","address","undefined","isConnected","useConnect","connect","connectors","useDisconnect","disconnect","useBalance","data","ethers","providers","JsonRpcProvider","Contract","utils","formatEther","parseEther","BigInt","prototype","toJSON","toString","global","fetch","window","ethereum","Object","defineProperty","writable","configurable","value","request","on","removeListener","isMetaMask","ResizeObserver","mockImplementation","observe","unobserve","IntersectionObserver","matches","media","onchange","addListener","addEventListener","removeEventListener","dispatchEvent","localStorageMock","getItem","setItem","removeItem","clear","localStorage","sessionStorageMock","sessionStorage","originalConsoleError","console","error","args","test"],"mappings":"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"}