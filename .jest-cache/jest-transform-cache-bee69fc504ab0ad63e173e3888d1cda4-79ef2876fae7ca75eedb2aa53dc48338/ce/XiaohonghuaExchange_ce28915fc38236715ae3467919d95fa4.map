{"version":3,"names":["_default","supabaseUrl","cov_ivamltpgg","s","b","process","env","NEXT_PUBLIC_SUPABASE_URL","supabaseAnonKey","NEXT_PUBLIC_SUPABASE_ANON_KEY","supabase","_supabasejs","createClient","initialState","xiaohonghuaBalance","exchangeRate","exchangeAmount","estimatedSm","loading","error","success","userSession","XiaohonghuaExchange","className","onExchangeComplete","f","address","isConnected","_wagmi","useAccount","state","setState","_react","useState","useEffect","getSession","data","auth","session","prev","fetchUserData","userResponse","rateResponse","Promise","all","from","select","eq","user","id","single","xiaohonghua_balance","xiaohonghua_to_sm_rate","err","console","handleAmountChange","useCallback","e","value","parseFloat","target","isNaN","Math","min","handleSetMax","handleExchange","response","fetch","method","headers","access_token","body","JSON","stringify","xiaohonghuaAmount","result","json","ok","Error","message","smAmount","isButtonDisabled","useMemo","renderContent","_jsxruntime","jsx","jsxs","Fragment","toLocaleString","type","onChange","placeholder","disabled","onClick"],"sources":["/Users/yudeyou/Desktop/sm/sociomint/src/XiaohonghuaExchange.tsx"],"sourcesContent":["import React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport { useAccount } from 'wagmi';\nimport { createClient } from '@supabase/supabase-js';\n\n// 创建Supabase客户端\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL || '';\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY || '';\nconst supabase = createClient(supabaseUrl, supabaseAnonKey);\n\ninterface XiaohonghuaExchangeProps {\n  className?: string;\n  onExchangeComplete?: () => void;\n}\n\ninterface ExchangeState {\n  xiaohonghuaBalance: number;\n  exchangeRate: number;\n  exchangeAmount: number;\n  estimatedSm: number;\n  loading: boolean;\n  error: string | null;\n  success: string | null;\n  userSession: any;\n}\n\nconst initialState: ExchangeState = {\n  xiaohonghuaBalance: 0,\n  exchangeRate: 10, // 默认1小红花=10SM\n  exchangeAmount: 0,\n  estimatedSm: 0,\n  loading: false,\n  error: null,\n  success: null,\n  userSession: null\n};\n\nconst XiaohonghuaExchange: React.FC<XiaohonghuaExchangeProps> = ({\n  className,\n  onExchangeComplete\n}) => {\n  const { address, isConnected } = useAccount();\n  const [state, setState] = useState<ExchangeState>(initialState);\n\n  const {\n    xiaohonghuaBalance,\n    exchangeRate,\n    exchangeAmount,\n    estimatedSm,\n    loading,\n    error,\n    success,\n    userSession\n  } = state;\n\n  // 获取用户会话\n  useEffect(() => {\n    const getSession = async () => {\n      const { data, error } = await supabase.auth.getSession();\n      if (data.session) {\n        setState(prev => ({ ...prev, userSession: data.session }));\n      }\n    };\n\n    getSession();\n  }, []);\n\n  // 获取用户小红花余额和兑换率\n  useEffect(() => {\n    const fetchUserData = async () => {\n      if (!userSession) return;\n\n      try {\n        // 并行获取用户数据和兑换率\n        const [userResponse, rateResponse] = await Promise.all([\n          supabase\n            .from('users')\n            .select('xiaohonghua_balance')\n            .eq('id', userSession.user.id)\n            .single(),\n          supabase\n            .from('exchange_rates')\n            .select('xiaohonghua_to_sm_rate')\n            .eq('is_active', true)\n            .single()\n        ]);\n\n        // 处理错误\n        if (userResponse.error) throw userResponse.error;\n        if (rateResponse.error) throw rateResponse.error;\n\n        // 更新状态\n        setState(prev => ({\n          ...prev,\n          xiaohonghuaBalance: userResponse.data?.xiaohonghua_balance || 0,\n          exchangeRate: rateResponse.data?.xiaohonghua_to_sm_rate || 10\n        }));\n      } catch (err) {\n        console.error('获取用户数据失败:', err);\n        setState(prev => ({ ...prev, error: '获取用户数据失败，请稍后再试' }));\n      }\n    };\n\n    fetchUserData();\n  }, [userSession]);\n\n  // 计算预估SM数量\n  useEffect(() => {\n    setState(prev => ({ ...prev, estimatedSm: prev.exchangeAmount * prev.exchangeRate }));\n  }, [exchangeAmount, exchangeRate]);\n\n  // 处理兑换金额变化\n  const handleAmountChange = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\n    const value = parseFloat(e.target.value);\n    setState(prev => ({\n      ...prev,\n      exchangeAmount: isNaN(value) || value < 0 ? 0 : Math.min(value, prev.xiaohonghuaBalance)\n    }));\n  }, []);\n\n  // 设置最大兑换金额\n  const handleSetMax = useCallback(() => {\n    setState(prev => ({ ...prev, exchangeAmount: prev.xiaohonghuaBalance }));\n  }, []);\n\n  // 提交兑换请求\n  const handleExchange = useCallback(async () => {\n    if (!userSession) {\n      setState(prev => ({ ...prev, error: '请先登录' }));\n      return;\n    }\n\n    if (exchangeAmount <= 0) {\n      setState(prev => ({ ...prev, error: '请输入有效的兑换金额' }));\n      return;\n    }\n\n    if (exchangeAmount > xiaohonghuaBalance) {\n      setState(prev => ({ ...prev, error: '兑换金额不能超过余额' }));\n      return;\n    }\n\n    try {\n      setState(prev => ({ ...prev, loading: true, error: null, success: null }));\n\n      // 调用Supabase Function进行兑换\n      const response = await fetch(`${supabaseUrl}/functions/v1/exchange-xiaohonghua`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${userSession.access_token}`\n        },\n        body: JSON.stringify({ xiaohonghuaAmount: exchangeAmount })\n      });\n\n      const result = await response.json();\n\n      if (!response.ok) {\n        throw new Error(result.message || '兑换请求失败');\n      }\n\n      // 更新状态\n      setState(prev => ({\n        ...prev,\n        xiaohonghuaBalance: prev.xiaohonghuaBalance - exchangeAmount,\n        exchangeAmount: 0,\n        success: `成功兑换 ${result.data.smAmount} SM`,\n        loading: false\n      }));\n\n      // 通知父组件兑换完成\n      if (onExchangeComplete) {\n        onExchangeComplete();\n      }\n    } catch (err: any) {\n      console.error('兑换失败:', err);\n      setState(prev => ({\n        ...prev,\n        error: err.message || '兑换失败，请稍后再试',\n        loading: false\n      }));\n    }\n  }, [exchangeAmount, xiaohonghuaBalance, userSession, onExchangeComplete]);\n\n  // 计算按钮状态\n  const isButtonDisabled = useMemo(() => {\n    return loading || exchangeAmount <= 0 || exchangeAmount > xiaohonghuaBalance;\n  }, [loading, exchangeAmount, xiaohonghuaBalance]);\n\n  // 渲染内容\n  const renderContent = () => {\n    if (!isConnected) {\n      return <p className=\"text-center text-gray-400\">请连接钱包使用兑换功能</p>;\n    }\n\n    if (!userSession) {\n      return <p className=\"text-center text-gray-400\">请登录以使用兑换功能</p>;\n    }\n\n    return (\n      <>\n        <h2 className=\"text-xl font-bold mb-4 text-white\">小红花兑换</h2>\n\n        <div className=\"mb-4\">\n          <div className=\"flex justify-between mb-1\">\n            <span className=\"text-gray-400\">小红花余额:</span>\n            <span className=\"text-white\">{xiaohonghuaBalance.toLocaleString()}</span>\n          </div>\n          <div className=\"flex justify-between mb-1\">\n            <span className=\"text-gray-400\">兑换比率:</span>\n            <span className=\"text-white\">1 小红花 = {exchangeRate} SM</span>\n          </div>\n        </div>\n\n        <div className=\"mb-4\">\n          <label className=\"block text-gray-400 mb-1\">兑换数量</label>\n          <div className=\"flex items-center\">\n            <input\n              type=\"number\"\n              value={exchangeAmount || ''}\n              onChange={handleAmountChange}\n              className=\"w-full bg-gray-700 text-white px-3 py-2 rounded-l-lg focus:outline-none\"\n              placeholder=\"输入小红花数量\"\n              disabled={loading}\n            />\n            <button\n              onClick={handleSetMax}\n              className=\"bg-gray-600 text-white px-3 py-2 rounded-r-lg hover:bg-gray-500\"\n              disabled={loading}\n            >\n              最大\n            </button>\n          </div>\n        </div>\n\n        <div className=\"mb-6 p-3 bg-gray-700 rounded-lg\">\n          <div className=\"flex justify-between\">\n            <span className=\"text-gray-400\">预计获得:</span>\n            <span className=\"text-white font-bold\">{estimatedSm.toLocaleString()} SM</span>\n          </div>\n        </div>\n\n        {error && (\n          <div className=\"mb-4 p-3 bg-red-900/30 border border-red-800 rounded-lg text-red-400\">\n            {error}\n          </div>\n        )}\n\n        {success && (\n          <div className=\"mb-4 p-3 bg-green-900/30 border border-green-800 rounded-lg text-green-400\">\n            {success}\n          </div>\n        )}\n\n        <button\n          onClick={handleExchange}\n          disabled={isButtonDisabled}\n          className={`w-full py-3 rounded-lg font-medium flex justify-center items-center\n            ${isButtonDisabled\n              ? 'bg-gray-600 text-gray-400 cursor-not-allowed'\n              : 'bg-gradient-to-r from-[#0de5ff] to-[#8b3dff] text-white hover:from-[#0bc9e0] hover:to-[#7a35e0]'\n            }`}\n        >\n          {loading ? '处理中...' : '兑换'}\n        </button>\n      </>\n    );\n  };\n\n  return (\n    <div className={`p-4 rounded-lg bg-gray-800 ${className}`}>\n      {renderContent()}\n    </div>\n  );\n};\n\nexport default XiaohonghuaExchange;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;+BAmRA;;;;;;WAAAA,QAAA;;;;;;;;wEAnRiE;;;iCACtC;;;iCACE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAE7B;AACA,MAAMC,WAAA;AAAA;AAAA,CAAAC,aAAA,GAAAC,CAAA;AAAc;AAAA,CAAAD,aAAA,GAAAE,CAAA,WAAAC,OAAA,CAAQC,GAAG,CAACC,wBAAwB;AAAA;AAAA,CAAAL,aAAA,GAAAE,CAAA,WAAI;AAC5D,MAAMI,eAAA;AAAA;AAAA,CAAAN,aAAA,GAAAC,CAAA;AAAkB;AAAA,CAAAD,aAAA,GAAAE,CAAA,WAAAC,OAAA,CAAQC,GAAG,CAACG,6BAA6B;AAAA;AAAA,CAAAP,aAAA,GAAAE,CAAA,WAAI;AACrE,MAAMM,QAAA;AAAA;AAAA,CAAAR,aAAA,GAAAC,CAAA,QAAW,IAAAQ,WAAA,CAAAC,YAAY,EAACX,WAAA,EAAaO,eAAA;AAkB3C,MAAMK,YAAA;AAAA;AAAA,CAAAX,aAAA,GAAAC,CAAA,QAA8B;EAClCW,kBAAA,EAAoB;EACpBC,YAAA,EAAc;EACdC,cAAA,EAAgB;EAChBC,WAAA,EAAa;EACbC,OAAA,EAAS;EACTC,KAAA,EAAO;EACPC,OAAA,EAAS;EACTC,WAAA,EAAa;AACf;AAAA;AAAAnB,aAAA,GAAAC,CAAA;AAEA,MAAMmB,mBAAA,GAA0DA,CAAC;EAC/DC,SAAS;EACTC;AAAkB,CACnB;EAAA;EAAAtB,aAAA,GAAAuB,CAAA;EACC,MAAM;IAAEC,OAAO;IAAEC;EAAW,CAAE;EAAA;EAAA,CAAAzB,aAAA,GAAAC,CAAA,QAAG,IAAAyB,MAAA,CAAAC,UAAU;EAC3C,MAAM,CAACC,KAAA,EAAOC,QAAA,CAAS;EAAA;EAAA,CAAA7B,aAAA,GAAAC,CAAA,QAAG,IAAA6B,MAAA,CAAAC,QAAQ,EAAgBpB,YAAA;EAElD,MAAM;IACJC,kBAAkB;IAClBC,YAAY;IACZC,cAAc;IACdC,WAAW;IACXC,OAAO;IACPC,KAAK;IACLC,OAAO;IACPC;EAAW,CACZ;EAAA;EAAA,CAAAnB,aAAA,GAAAC,CAAA,QAAG2B,KAAA;EAEJ;EAAA;EAAA5B,aAAA,GAAAC,CAAA;EACA,IAAA6B,MAAA,CAAAE,SAAS,EAAC;IAAA;IAAAhC,aAAA,GAAAuB,CAAA;IAAAvB,aAAA,GAAAC,CAAA;IACR,MAAMgC,UAAA,GAAa,MAAAA,CAAA;MAAA;MAAAjC,aAAA,GAAAuB,CAAA;MACjB,MAAM;QAAEW,IAAI;QAAEjB;MAAK,CAAE;MAAA;MAAA,CAAAjB,aAAA,GAAAC,CAAA,QAAG,MAAMO,QAAA,CAAS2B,IAAI,CAACF,UAAU;MAAA;MAAAjC,aAAA,GAAAC,CAAA;MACtD,IAAIiC,IAAA,CAAKE,OAAO,EAAE;QAAA;QAAApC,aAAA,GAAAE,CAAA;QAAAF,aAAA,GAAAC,CAAA;QAChB4B,QAAA,CAASQ,IAAA,IAAS;UAAA;UAAArC,aAAA,GAAAuB,CAAA;UAAAvB,aAAA,GAAAC,CAAA;UAAA;YAAE,GAAGoC,IAAI;YAAElB,WAAA,EAAae,IAAA,CAAKE;UAAQ;QAAA;MACzD;MAAA;MAAA;QAAApC,aAAA,GAAAE,CAAA;MAAA;IACF;IAAA;IAAAF,aAAA,GAAAC,CAAA;IAEAgC,UAAA;EACF,GAAG,EAAE;EAEL;EAAA;EAAAjC,aAAA,GAAAC,CAAA;EACA,IAAA6B,MAAA,CAAAE,SAAS,EAAC;IAAA;IAAAhC,aAAA,GAAAuB,CAAA;IAAAvB,aAAA,GAAAC,CAAA;IACR,MAAMqC,aAAA,GAAgB,MAAAA,CAAA;MAAA;MAAAtC,aAAA,GAAAuB,CAAA;MAAAvB,aAAA,GAAAC,CAAA;MACpB,IAAI,CAACkB,WAAA,EAAa;QAAA;QAAAnB,aAAA,GAAAE,CAAA;QAAAF,aAAA,GAAAC,CAAA;QAAA;MAAA;MAAA;MAAA;QAAAD,aAAA,GAAAE,CAAA;MAAA;MAAAF,aAAA,GAAAC,CAAA;MAElB,IAAI;QACF;QACA,MAAM,CAACsC,YAAA,EAAcC,YAAA,CAAa;QAAA;QAAA,CAAAxC,aAAA,GAAAC,CAAA,QAAG,MAAMwC,OAAA,CAAQC,GAAG,CAAC,CACrDlC,QAAA,CACGmC,IAAI,CAAC,SACLC,MAAM,CAAC,uBACPC,EAAE,CAAC,MAAM1B,WAAA,CAAY2B,IAAI,CAACC,EAAE,EAC5BC,MAAM,IACTxC,QAAA,CACGmC,IAAI,CAAC,kBACLC,MAAM,CAAC,0BACPC,EAAE,CAAC,aAAa,MAChBG,MAAM,GACV;QAED;QAAA;QAAAhD,aAAA,GAAAC,CAAA;QACA,IAAIsC,YAAA,CAAatB,KAAK,EAAE;UAAA;UAAAjB,aAAA,GAAAE,CAAA;UAAAF,aAAA,GAAAC,CAAA;UAAA,MAAMsC,YAAA,CAAatB,KAAK;QAAA;QAAA;QAAA;UAAAjB,aAAA,GAAAE,CAAA;QAAA;QAAAF,aAAA,GAAAC,CAAA;QAChD,IAAIuC,YAAA,CAAavB,KAAK,EAAE;UAAA;UAAAjB,aAAA,GAAAE,CAAA;UAAAF,aAAA,GAAAC,CAAA;UAAA,MAAMuC,YAAA,CAAavB,KAAK;QAAA;QAAA;QAAA;UAAAjB,aAAA,GAAAE,CAAA;QAAA;QAEhD;QAAAF,aAAA,GAAAC,CAAA;QACA4B,QAAA,CAASQ,IAAA,IAAS;UAAA;UAAArC,aAAA,GAAAuB,CAAA;UAAAvB,aAAA,GAAAC,CAAA;UAAA;YAChB,GAAGoC,IAAI;YACPzB,kBAAA;YAAoB;YAAA,CAAAZ,aAAA,GAAAE,CAAA,WAAAqC,YAAA,CAAaL,IAAI,EAAEe,mBAAA;YAAA;YAAA,CAAAjD,aAAA,GAAAE,CAAA,WAAuB;YAC9DW,YAAA;YAAc;YAAA,CAAAb,aAAA,GAAAE,CAAA,WAAAsC,YAAA,CAAaN,IAAI,EAAEgB,sBAAA;YAAA;YAAA,CAAAlD,aAAA,GAAAE,CAAA,WAA0B;UAC7D;QAAA;MACF,EAAE,OAAOiD,GAAA,EAAK;QAAA;QAAAnD,aAAA,GAAAC,CAAA;QACZmD,OAAA,CAAQnC,KAAK,CAAC,aAAakC,GAAA;QAAA;QAAAnD,aAAA,GAAAC,CAAA;QAC3B4B,QAAA,CAASQ,IAAA,IAAS;UAAA;UAAArC,aAAA,GAAAuB,CAAA;UAAAvB,aAAA,GAAAC,CAAA;UAAA;YAAE,GAAGoC,IAAI;YAAEpB,KAAA,EAAO;UAAiB;QAAA;MACvD;IACF;IAAA;IAAAjB,aAAA,GAAAC,CAAA;IAEAqC,aAAA;EACF,GAAG,CAACnB,WAAA,CAAY;EAEhB;EAAA;EAAAnB,aAAA,GAAAC,CAAA;EACA,IAAA6B,MAAA,CAAAE,SAAS,EAAC;IAAA;IAAAhC,aAAA,GAAAuB,CAAA;IAAAvB,aAAA,GAAAC,CAAA;IACR4B,QAAA,CAASQ,IAAA,IAAS;MAAA;MAAArC,aAAA,GAAAuB,CAAA;MAAAvB,aAAA,GAAAC,CAAA;MAAA;QAAE,GAAGoC,IAAI;QAAEtB,WAAA,EAAasB,IAAA,CAAKvB,cAAc,GAAGuB,IAAA,CAAKxB;MAAa;IAAA;EACpF,GAAG,CAACC,cAAA,EAAgBD,YAAA,CAAa;EAEjC;EACA,MAAMwC,kBAAA;EAAA;EAAA,CAAArD,aAAA,GAAAC,CAAA,QAAqB,IAAA6B,MAAA,CAAAwB,WAAW,EAAEC,CAAA;IAAA;IAAAvD,aAAA,GAAAuB,CAAA;IACtC,MAAMiC,KAAA;IAAA;IAAA,CAAAxD,aAAA,GAAAC,CAAA,QAAQwD,UAAA,CAAWF,CAAA,CAAEG,MAAM,CAACF,KAAK;IAAA;IAAAxD,aAAA,GAAAC,CAAA;IACvC4B,QAAA,CAASQ,IAAA,IAAS;MAAA;MAAArC,aAAA,GAAAuB,CAAA;MAAAvB,aAAA,GAAAC,CAAA;MAAA;QAChB,GAAGoC,IAAI;QACPvB,cAAA;QAAgB;QAAA,CAAAd,aAAA,GAAAE,CAAA,WAAAyD,KAAA,CAAMH,KAAA;QAAA;QAAA,CAAAxD,aAAA,GAAAE,CAAA,WAAUsD,KAAA,GAAQ;QAAA;QAAA,CAAAxD,aAAA,GAAAE,CAAA,WAAI;QAAA;QAAA,CAAAF,aAAA,GAAAE,CAAA,WAAI0D,IAAA,CAAKC,GAAG,CAACL,KAAA,EAAOnB,IAAA,CAAKzB,kBAAkB;MACzF;IAAA;EACF,GAAG,EAAE;EAEL;EACA,MAAMkD,YAAA;EAAA;EAAA,CAAA9D,aAAA,GAAAC,CAAA,QAAe,IAAA6B,MAAA,CAAAwB,WAAW,EAAC;IAAA;IAAAtD,aAAA,GAAAuB,CAAA;IAAAvB,aAAA,GAAAC,CAAA;IAC/B4B,QAAA,CAASQ,IAAA,IAAS;MAAA;MAAArC,aAAA,GAAAuB,CAAA;MAAAvB,aAAA,GAAAC,CAAA;MAAA;QAAE,GAAGoC,IAAI;QAAEvB,cAAA,EAAgBuB,IAAA,CAAKzB;MAAmB;IAAA;EACvE,GAAG,EAAE;EAEL;EACA,MAAMmD,cAAA;EAAA;EAAA,CAAA/D,aAAA,GAAAC,CAAA,QAAiB,IAAA6B,MAAA,CAAAwB,WAAW,EAAC;IAAA;IAAAtD,aAAA,GAAAuB,CAAA;IAAAvB,aAAA,GAAAC,CAAA;IACjC,IAAI,CAACkB,WAAA,EAAa;MAAA;MAAAnB,aAAA,GAAAE,CAAA;MAAAF,aAAA,GAAAC,CAAA;MAChB4B,QAAA,CAASQ,IAAA,IAAS;QAAA;QAAArC,aAAA,GAAAuB,CAAA;QAAAvB,aAAA,GAAAC,CAAA;QAAA;UAAE,GAAGoC,IAAI;UAAEpB,KAAA,EAAO;QAAO;MAAA;MAAA;MAAAjB,aAAA,GAAAC,CAAA;MAC3C;IACF;IAAA;IAAA;MAAAD,aAAA,GAAAE,CAAA;IAAA;IAAAF,aAAA,GAAAC,CAAA;IAEA,IAAIa,cAAA,IAAkB,GAAG;MAAA;MAAAd,aAAA,GAAAE,CAAA;MAAAF,aAAA,GAAAC,CAAA;MACvB4B,QAAA,CAASQ,IAAA,IAAS;QAAA;QAAArC,aAAA,GAAAuB,CAAA;QAAAvB,aAAA,GAAAC,CAAA;QAAA;UAAE,GAAGoC,IAAI;UAAEpB,KAAA,EAAO;QAAa;MAAA;MAAA;MAAAjB,aAAA,GAAAC,CAAA;MACjD;IACF;IAAA;IAAA;MAAAD,aAAA,GAAAE,CAAA;IAAA;IAAAF,aAAA,GAAAC,CAAA;IAEA,IAAIa,cAAA,GAAiBF,kBAAA,EAAoB;MAAA;MAAAZ,aAAA,GAAAE,CAAA;MAAAF,aAAA,GAAAC,CAAA;MACvC4B,QAAA,CAASQ,IAAA,IAAS;QAAA;QAAArC,aAAA,GAAAuB,CAAA;QAAAvB,aAAA,GAAAC,CAAA;QAAA;UAAE,GAAGoC,IAAI;UAAEpB,KAAA,EAAO;QAAa;MAAA;MAAA;MAAAjB,aAAA,GAAAC,CAAA;MACjD;IACF;IAAA;IAAA;MAAAD,aAAA,GAAAE,CAAA;IAAA;IAAAF,aAAA,GAAAC,CAAA;IAEA,IAAI;MAAA;MAAAD,aAAA,GAAAC,CAAA;MACF4B,QAAA,CAASQ,IAAA,IAAS;QAAA;QAAArC,aAAA,GAAAuB,CAAA;QAAAvB,aAAA,GAAAC,CAAA;QAAA;UAAE,GAAGoC,IAAI;UAAErB,OAAA,EAAS;UAAMC,KAAA,EAAO;UAAMC,OAAA,EAAS;QAAK;MAAA;MAEvE;MACA,MAAM8C,QAAA;MAAA;MAAA,CAAAhE,aAAA,GAAAC,CAAA,QAAW,MAAMgE,KAAA,CAAM,GAAGlE,WAAA,oCAA+C,EAAE;QAC/EmE,MAAA,EAAQ;QACRC,OAAA,EAAS;UACP,gBAAgB;UAChB,iBAAiB,UAAUhD,WAAA,CAAYiD,YAAY;QACrD;QACAC,IAAA,EAAMC,IAAA,CAAKC,SAAS,CAAC;UAAEC,iBAAA,EAAmB1D;QAAe;MAC3D;MAEA,MAAM2D,MAAA;MAAA;MAAA,CAAAzE,aAAA,GAAAC,CAAA,QAAS,MAAM+D,QAAA,CAASU,IAAI;MAAA;MAAA1E,aAAA,GAAAC,CAAA;MAElC,IAAI,CAAC+D,QAAA,CAASW,EAAE,EAAE;QAAA;QAAA3E,aAAA,GAAAE,CAAA;QAAAF,aAAA,GAAAC,CAAA;QAChB,MAAM,IAAI2E,KAAA;QAAM;QAAA,CAAA5E,aAAA,GAAAE,CAAA,WAAAuE,MAAA,CAAOI,OAAO;QAAA;QAAA,CAAA7E,aAAA,GAAAE,CAAA,WAAI;MACpC;MAAA;MAAA;QAAAF,aAAA,GAAAE,CAAA;MAAA;MAEA;MAAAF,aAAA,GAAAC,CAAA;MACA4B,QAAA,CAASQ,IAAA,IAAS;QAAA;QAAArC,aAAA,GAAAuB,CAAA;QAAAvB,aAAA,GAAAC,CAAA;QAAA;UAChB,GAAGoC,IAAI;UACPzB,kBAAA,EAAoByB,IAAA,CAAKzB,kBAAkB,GAAGE,cAAA;UAC9CA,cAAA,EAAgB;UAChBI,OAAA,EAAS,QAAQuD,MAAA,CAAOvC,IAAI,CAAC4C,QAAQ,KAAK;UAC1C9D,OAAA,EAAS;QACX;MAAA;MAEA;MAAA;MAAAhB,aAAA,GAAAC,CAAA;MACA,IAAIqB,kBAAA,EAAoB;QAAA;QAAAtB,aAAA,GAAAE,CAAA;QAAAF,aAAA,GAAAC,CAAA;QACtBqB,kBAAA;MACF;MAAA;MAAA;QAAAtB,aAAA,GAAAE,CAAA;MAAA;IACF,EAAE,OAAOiD,GAAA,EAAU;MAAA;MAAAnD,aAAA,GAAAC,CAAA;MACjBmD,OAAA,CAAQnC,KAAK,CAAC,SAASkC,GAAA;MAAA;MAAAnD,aAAA,GAAAC,CAAA;MACvB4B,QAAA,CAASQ,IAAA,IAAS;QAAA;QAAArC,aAAA,GAAAuB,CAAA;QAAAvB,aAAA,GAAAC,CAAA;QAAA;UAChB,GAAGoC,IAAI;UACPpB,KAAA;UAAO;UAAA,CAAAjB,aAAA,GAAAE,CAAA,WAAAiD,GAAA,CAAI0B,OAAO;UAAA;UAAA,CAAA7E,aAAA,GAAAE,CAAA,WAAI;UACtBc,OAAA,EAAS;QACX;MAAA;IACF;EACF,GAAG,CAACF,cAAA,EAAgBF,kBAAA,EAAoBO,WAAA,EAAaG,kBAAA,CAAmB;EAExE;EACA,MAAMyD,gBAAA;EAAA;EAAA,CAAA/E,aAAA,GAAAC,CAAA,SAAmB,IAAA6B,MAAA,CAAAkD,OAAO,EAAC;IAAA;IAAAhF,aAAA,GAAAuB,CAAA;IAAAvB,aAAA,GAAAC,CAAA;IAC/B,OAAO,2BAAAD,aAAA,GAAAE,CAAA,WAAAc,OAAA;IAAA;IAAA,CAAAhB,aAAA,GAAAE,CAAA,WAAWY,cAAA,IAAkB;IAAA;IAAA,CAAAd,aAAA,GAAAE,CAAA,WAAKY,cAAA,GAAiBF,kBAAA;EAC5D,GAAG,CAACI,OAAA,EAASF,cAAA,EAAgBF,kBAAA,CAAmB;EAEhD;EAAA;EAAAZ,aAAA,GAAAC,CAAA;EACA,MAAMgF,aAAA,GAAgBA,CAAA;IAAA;IAAAjF,aAAA,GAAAuB,CAAA;IAAAvB,aAAA,GAAAC,CAAA;IACpB,IAAI,CAACwB,WAAA,EAAa;MAAA;MAAAzB,aAAA,GAAAE,CAAA;MAAAF,aAAA,GAAAC,CAAA;MAChB,oBAAO,IAAAiF,WAAA,CAAAC,GAAA,EAAC;QAAE9D,SAAA,EAAU;kBAA4B;;IAClD;IAAA;IAAA;MAAArB,aAAA,GAAAE,CAAA;IAAA;IAAAF,aAAA,GAAAC,CAAA;IAEA,IAAI,CAACkB,WAAA,EAAa;MAAA;MAAAnB,aAAA,GAAAE,CAAA;MAAAF,aAAA,GAAAC,CAAA;MAChB,oBAAO,IAAAiF,WAAA,CAAAC,GAAA,EAAC;QAAE9D,SAAA,EAAU;kBAA4B;;IAClD;IAAA;IAAA;MAAArB,aAAA,GAAAE,CAAA;IAAA;IAAAF,aAAA,GAAAC,CAAA;IAEA,oBACE,IAAAiF,WAAA,CAAAE,IAAA,EAAAF,WAAA,CAAAG,QAAA;8BACE,IAAAH,WAAA,CAAAC,GAAA,EAAC;QAAG9D,SAAA,EAAU;kBAAoC;uBAElD,IAAA6D,WAAA,CAAAE,IAAA,EAAC;QAAI/D,SAAA,EAAU;gCACb,IAAA6D,WAAA,CAAAE,IAAA,EAAC;UAAI/D,SAAA,EAAU;kCACb,IAAA6D,WAAA,CAAAC,GAAA,EAAC;YAAK9D,SAAA,EAAU;sBAAgB;2BAChC,IAAA6D,WAAA,CAAAC,GAAA,EAAC;YAAK9D,SAAA,EAAU;sBAAcT,kBAAA,CAAmB0E,cAAc;;yBAEjE,IAAAJ,WAAA,CAAAE,IAAA,EAAC;UAAI/D,SAAA,EAAU;kCACb,IAAA6D,WAAA,CAAAC,GAAA,EAAC;YAAK9D,SAAA,EAAU;sBAAgB;2BAChC,IAAA6D,WAAA,CAAAE,IAAA,EAAC;YAAK/D,SAAA,EAAU;uBAAa,YAASR,YAAA,EAAa;;;uBAIvD,IAAAqE,WAAA,CAAAE,IAAA,EAAC;QAAI/D,SAAA,EAAU;gCACb,IAAA6D,WAAA,CAAAC,GAAA,EAAC;UAAM9D,SAAA,EAAU;oBAA2B;yBAC5C,IAAA6D,WAAA,CAAAE,IAAA,EAAC;UAAI/D,SAAA,EAAU;kCACb,IAAA6D,WAAA,CAAAC,GAAA,EAAC;YACCI,IAAA,EAAK;YACL/B,KAAA;YAAO;YAAA,CAAAxD,aAAA,GAAAE,CAAA,WAAAY,cAAA;YAAA;YAAA,CAAAd,aAAA,GAAAE,CAAA,WAAkB;YACzBsF,QAAA,EAAUnC,kBAAA;YACVhC,SAAA,EAAU;YACVoE,WAAA,EAAY;YACZC,QAAA,EAAU1E;2BAEZ,IAAAkE,WAAA,CAAAC,GAAA,EAAC;YACCQ,OAAA,EAAS7B,YAAA;YACTzC,SAAA,EAAU;YACVqE,QAAA,EAAU1E,OAAA;sBACX;;;uBAML,IAAAkE,WAAA,CAAAC,GAAA,EAAC;QAAI9D,SAAA,EAAU;kBACb,iBAAA6D,WAAA,CAAAE,IAAA,EAAC;UAAI/D,SAAA,EAAU;kCACb,IAAA6D,WAAA,CAAAC,GAAA,EAAC;YAAK9D,SAAA,EAAU;sBAAgB;2BAChC,IAAA6D,WAAA,CAAAE,IAAA,EAAC;YAAK/D,SAAA,EAAU;uBAAwBN,WAAA,CAAYuE,cAAc,IAAG;;;;MAIxE;MAAA,CAAAtF,aAAA,GAAAE,CAAA,WAAAe,KAAA;MAAA;MAAA,CAAAjB,aAAA,GAAAE,CAAA,wBACC,IAAAgF,WAAA,CAAAC,GAAA,EAAC;QAAI9D,SAAA,EAAU;kBACZJ;;MAIJ;MAAA,CAAAjB,aAAA,GAAAE,CAAA,WAAAgB,OAAA;MAAA;MAAA,CAAAlB,aAAA,GAAAE,CAAA,wBACC,IAAAgF,WAAA,CAAAC,GAAA,EAAC;QAAI9D,SAAA,EAAU;kBACZH;wBAIL,IAAAgE,WAAA,CAAAC,GAAA,EAAC;QACCQ,OAAA,EAAS5B,cAAA;QACT2B,QAAA,EAAUX,gBAAA;QACV1D,SAAA,EAAW;cACP0D,gBAAA;QAAA;QAAA,CAAA/E,aAAA,GAAAE,CAAA,WACE;QAAA;QAAA,CAAAF,aAAA,GAAAE,CAAA,WACA,oGACF;kBAEHc,OAAA;QAAA;QAAA,CAAAhB,aAAA,GAAAE,CAAA,WAAU;QAAA;QAAA,CAAAF,aAAA,GAAAE,CAAA,WAAW;;;EAI9B;EAAA;EAAAF,aAAA,GAAAC,CAAA;EAEA,oBACE,IAAAiF,WAAA,CAAAC,GAAA,EAAC;IAAI9D,SAAA,EAAW,8BAA8BA,SAAA,EAAW;cACtD4D,aAAA;;AAGP;MAEAnF,QAAA;AAAA;AAAA,CAAAE,aAAA,GAAAC,CAAA,SAAemB,mBAAA","ignoreList":[]}