{"version":3,"names":["cov_y1hups9iu","actualCoverage","s","OptimizedLanguageProvider","f","default","_default","useOptimizedLanguage","withTranslation","LanguageContext","_react","createContext","undefined","children","t","i18n","_reacti18next","useTranslation","currentLanguage","setCurrentLanguage","useState","_i18n","defaultLocale","isLoading","setIsLoading","useEffect","savedLanguage","localStorage","getItem","b","changeLanguage","useCallback","locale","loadLanguage","setItem","error","console","optimizedT","key","options","value","_jsxruntime","jsx","Provider","context","useContext","Error","Component","WrappedComponent","props","displayName","name"],"sources":["/Users/yudeyou/Desktop/sm/sociomint/src/contexts/OptimizedLanguageContext.tsx"],"sourcesContent":["'use client';\n\nimport React, { createContext, useContext, useState, useEffect, useCallback, ReactNode } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Locale, defaultLocale, loadLanguage } from '@/lib/i18n';\n\ninterface LanguageContextType {\n  currentLanguage: Locale;\n  changeLanguage: (locale: Locale) => Promise<void>;\n  t: (key: string, options?: any) => string;\n  isLoading: boolean;\n}\n\nconst LanguageContext = createContext<LanguageContextType | undefined>(undefined);\n\ninterface LanguageProviderProps {\n  children: ReactNode;\n}\n\nexport function OptimizedLanguageProvider({ children }: LanguageProviderProps) {\n  const { t, i18n } = useTranslation();\n  const [currentLanguage, setCurrentLanguage] = useState<Locale>(defaultLocale);\n  const [isLoading, setIsLoading] = useState(false);\n\n  // 初始化语言设置\n  useEffect(() => {\n    const savedLanguage = localStorage.getItem('language') as Locale;\n    if (savedLanguage && savedLanguage !== defaultLocale) {\n      changeLanguage(savedLanguage);\n    }\n  }, []);\n\n  // 优化的语言切换函数\n  const changeLanguage = useCallback(async (locale: Locale) => {\n    if (locale === currentLanguage) return;\n    \n    setIsLoading(true);\n    try {\n      await loadLanguage(locale);\n      setCurrentLanguage(locale);\n      localStorage.setItem('language', locale);\n    } catch (error) {\n      console.error('Failed to change language:', error);\n    } finally {\n      setIsLoading(false);\n    }\n  }, [currentLanguage]);\n\n  // 优化的翻译函数\n  const optimizedT = useCallback((key: string, options?: any) => {\n    return t(key, options);\n  }, [t]);\n\n  const value: LanguageContextType = {\n    currentLanguage,\n    changeLanguage,\n    t: optimizedT,\n    isLoading,\n  };\n\n  return (\n    <LanguageContext.Provider value={value}>\n      {children}\n    </LanguageContext.Provider>\n  );\n}\n\nexport function useOptimizedLanguage() {\n  const context = useContext(LanguageContext);\n  if (context === undefined) {\n    throw new Error('useOptimizedLanguage must be used within an OptimizedLanguageProvider');\n  }\n  return context;\n}\n\n// 高阶组件，用于包装需要翻译的组件\nexport function withTranslation<P extends object>(\n  Component: React.ComponentType<P>\n) {\n  const WrappedComponent = (props: P) => {\n    const { t } = useOptimizedLanguage();\n    return <Component {...props} t={t} />;\n  };\n  \n  WrappedComponent.displayName = `withTranslation(${Component.displayName || Component.name})`;\n  return WrappedComponent;\n}\n\nexport default OptimizedLanguageProvider;\n"],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}